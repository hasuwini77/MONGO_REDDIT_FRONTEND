{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/hasuwini/Documents/Frontend/MONGO-REDDIT/ed-frontend/actions/get-posts.ts"],"sourcesContent":["// actions/get-posts.ts\n'use server'\n\nimport { client } from 'lib/client'\nimport { ServerActionResponse } from 'lib/error-handling'\n\ninterface Post {\n  _id: string\n  title: string\n  content: string\n  author: {\n    username: string\n  }\n  comments: Array<{\n    content: string\n    author: {\n      username: string\n    }\n  }>\n  createdAt: string\n}\n\nexport const getPosts = async (): Promise<ServerActionResponse<Post[]>> => {\n  try {\n    console.log('Server Action: Fetching all posts')\n    const response = await client.get('/posts')\n    console.log('Server Action: API response:', response.data)\n    return { data: response.data }\n  } catch (error: any) {\n    console.error(\n      'Server Action: Error:',\n      error.response?.data || error.message,\n    )\n    return {\n      error:\n        error.response?.data?.message ||\n        error.message ||\n        'Failed to fetch posts',\n    }\n  }\n}\n"],"names":[],"mappings":"AAAA,uBAAuB;;;;;;IAsBV"}},
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///Users/hasuwini/Documents/Frontend/MONGO-REDDIT/ed-frontend/lib/error-handling.ts"],"sourcesContent":["import { isAxiosError } from 'axios'\nimport { isRedirectError } from 'next/dist/client/components/redirect'\nimport { toast } from 'sonner'\n\n// lib/error-handling.ts\n\nexport type ServerActionResponse<T = any> =\n  | { data: T; error?: never } // Success case\n  | { data?: never; error: string } // Error case\n\nexport const handleServerActionError = <T>(\n  response: ServerActionResponse<T>,\n): T => {\n  if ('error' in response) {\n    throw new Error(response.error)\n  }\n  return response.data\n}\nexport const handleAxiosError = (error: unknown): ServerActionResponse => {\n  const defaultErrorMessage = 'something went wrong'\n\n  if (!isAxiosError(error)) {\n    console.error(error)\n    return { error: defaultErrorMessage }\n  }\n\n  return { error: error.response?.data.message || defaultErrorMessage }\n}\n\nexport const toastServerError = (error: Error) => {\n  if (!isRedirectError(error)) {\n    toast.error(error.message)\n  }\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AAFA;;;;AAUO,MAAM,0BAA0B,CACrC;IAEA,IAAI,WAAW,UAAU;QACvB,MAAM,IAAI,MAAM,SAAS,KAAK;IAChC;IACA,OAAO,SAAS,IAAI;AACtB;AACO,MAAM,mBAAmB,CAAC;IAC/B,MAAM,sBAAsB;IAE5B,IAAI,CAAC,CAAA,GAAA,iJAAA,CAAA,eAAY,AAAD,EAAE,QAAQ;QACxB,QAAQ,KAAK,CAAC;QACd,OAAO;YAAE,OAAO;QAAoB;IACtC;IAEA,OAAO;QAAE,OAAO,MAAM,QAAQ,EAAE,KAAK,WAAW;IAAoB;AACtE;AAEO,MAAM,mBAAmB,CAAC;IAC/B,IAAI,CAAC,CAAA,GAAA,mKAAA,CAAA,kBAAe,AAAD,EAAE,QAAQ;QAC3B,2IAAA,CAAA,QAAK,CAAC,KAAK,CAAC,MAAM,OAAO;IAC3B;AACF"}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///Users/hasuwini/Documents/Frontend/MONGO-REDDIT/ed-frontend/app/%28main%29/posts/page.tsx"],"sourcesContent":["'use client'\n\nimport { useMutation } from '@tanstack/react-query'\nimport { getPosts } from 'actions/get-posts'\nimport { handleServerActionError } from 'lib/error-handling'\nimport Link from 'next/link'\nimport { useEffect } from 'react'\nimport { Post } from 'types/types'\n\nconst MyPosts = () => {\n  const {\n    mutate,\n    data: posts,\n    isPending,\n    error,\n  } = useMutation({\n    mutationFn: async () => {\n      console.log('Fetching all posts') // Debug log\n      const result = await getPosts()\n      console.log('Server response:', result) // Debug log\n      return handleServerActionError(result) as Post[]\n    },\n    onError: (error) => {\n      console.error('Error fetching posts:', error) // Error log\n    },\n    onSuccess: (data) => {\n      console.log('Successfully fetched posts:', data) // Success log\n    },\n  })\n\n  useEffect(() => {\n    console.log('Effect triggered') // Debug log\n    mutate()\n  }, [mutate])\n\n  if (isPending) {\n    return (\n      <div className='flex items-center justify-center p-4'>\n        <div className='text-lg'>Loading posts...</div>\n      </div>\n    )\n  }\n\n  if (error) {\n    return (\n      <div className='flex items-center justify-center p-4'>\n        <div className='text-red-500'>\n          Error loading posts:{' '}\n          {error instanceof Error ? error.message : 'Unknown error'}\n        </div>\n      </div>\n    )\n  }\n\n  if (!posts || posts.length === 0) {\n    return (\n      <div className='flex items-center justify-center p-4'>\n        <div className='text-lg'>No posts found</div>\n      </div>\n    )\n  }\n\n  return (\n    <div className='mx-auto max-w-4xl p-4'>\n      <h1 className='mb-6 text-3xl font-bold'>All Posts</h1>\n      <div className='space-y-6'>\n        {posts.map((post) => (\n          <Link\n            href={`/posts/${post._id}`}\n            key={post._id}\n            className='block rounded-lg border p-4 transition hover:bg-gray-50'\n          >\n            <article>\n              <h2 className='text-xl font-semibold'>{post.title}</h2>\n              <div className='mt-2 text-gray-600'>\n                {post.content.length > 150\n                  ? `${post.content.substring(0, 150)}...`\n                  : post.content}\n              </div>\n              <div className='mt-2 text-sm text-gray-500'>\n                Posted by {post.author.username} â€¢{' '}\n                {new Date(post.createdAt).toLocaleDateString()}\n              </div>\n              <div className='mt-2 text-sm text-gray-500'>\n                {post.comments.length} comment\n                {post.comments.length !== 1 ? 's' : ''}\n              </div>\n            </article>\n          </Link>\n        ))}\n      </div>\n    </div>\n  )\n}\n\nexport default MyPosts\n"],"names":[],"mappings":";;;;AAGA;AACA;AACA;AACA;AAJA;;;AAFA;;;;;;AASA,MAAM,UAAU;;IACd,MAAM,EACJ,MAAM,EACN,MAAM,KAAK,EACX,SAAS,EACT,KAAK,EACN,GAAG,CAAA,GAAA,iLAAA,CAAA,cAAW,AAAD,EAAE;QACd,UAAU;mCAAE;gBACV,QAAQ,GAAG,CAAC,sBAAsB,YAAY;;gBAC9C,MAAM,SAAS,MAAM,CAAA,GAAA,0HAAA,CAAA,WAAQ,AAAD;gBAC5B,QAAQ,GAAG,CAAC,oBAAoB,QAAQ,YAAY;;gBACpD,OAAO,CAAA,GAAA,2HAAA,CAAA,0BAAuB,AAAD,EAAE;YACjC;;QACA,OAAO;mCAAE,CAAC;gBACR,QAAQ,KAAK,CAAC,yBAAyB,OAAO,YAAY;;YAC5D;;QACA,SAAS;mCAAE,CAAC;gBACV,QAAQ,GAAG,CAAC,+BAA+B,MAAM,cAAc;;YACjE;;IACF;IAEA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;6BAAE;YACR,QAAQ,GAAG,CAAC,oBAAoB,YAAY;;YAC5C;QACF;4BAAG;QAAC;KAAO;IAEX,IAAI,WAAW;QACb,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;0BAAU;;;;;;;;;;;IAG/B;IAEA,IAAI,OAAO;QACT,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;oBAAe;oBACP;oBACpB,iBAAiB,QAAQ,MAAM,OAAO,GAAG;;;;;;;;;;;;IAIlD;IAEA,IAAI,CAAC,SAAS,MAAM,MAAM,KAAK,GAAG;QAChC,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;0BAAU;;;;;;;;;;;IAG/B;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;0BAA0B;;;;;;0BACxC,6LAAC;gBAAI,WAAU;0BACZ,MAAM,GAAG,CAAC,CAAC,qBACV,6LAAC,+HAAA,CAAA,UAAI;wBACH,MAAM,CAAC,OAAO,EAAE,KAAK,GAAG,EAAE;wBAE1B,WAAU;kCAEV,cAAA,6LAAC;;8CACC,6LAAC;oCAAG,WAAU;8CAAyB,KAAK,KAAK;;;;;;8CACjD,6LAAC;oCAAI,WAAU;8CACZ,KAAK,OAAO,CAAC,MAAM,GAAG,MACnB,GAAG,KAAK,OAAO,CAAC,SAAS,CAAC,GAAG,KAAK,GAAG,CAAC,GACtC,KAAK,OAAO;;;;;;8CAElB,6LAAC;oCAAI,WAAU;;wCAA6B;wCAC/B,KAAK,MAAM,CAAC,QAAQ;wCAAC;wCAAG;wCAClC,IAAI,KAAK,KAAK,SAAS,EAAE,kBAAkB;;;;;;;8CAE9C,6LAAC;oCAAI,WAAU;;wCACZ,KAAK,QAAQ,CAAC,MAAM;wCAAC;wCACrB,KAAK,QAAQ,CAAC,MAAM,KAAK,IAAI,MAAM;;;;;;;;;;;;;uBAhBnC,KAAK,GAAG;;;;;;;;;;;;;;;;AAwBzB;GApFM;;QAMA,iLAAA,CAAA,cAAW;;;KANX;uCAsFS"}},
    {"offset": {"line": 265, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}